---
title: "Exploraotry Data Analysis"
author: "javaria"
date: '2022-09-30'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Describe Functions.

```{r}
perc <- function(data) {
  percent <- data %>% ungroup() %>% mutate(Percentage = (n/sum(n))*100)
  return(percent)
}

```


```{r}
library(tidyverse)
library(formattable)
library(leaflet)
```


# Read Dataset

```{r}
df_Course <- read_csv("Data/Data - DS C1 Course.csv")
```

# Univariate Analysis


## Table of Age

```{r}
data_Age <- df_Course %>% group_by(Age)%>% count()%>% arrange(desc(n))
perc(data_Age)
```


### Get top 7 Age Numbers


```{r}
Age_Name  <- data_Age %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(Age_Name)
```


### Bar chart of Age

```{r}
ggplot(data = Age_Name, aes(x= n, y= Age ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of Age")
 
```


## Table of How and where did you hear about this course?

```{r}
data_Platform <- df_Course %>% group_by(`How and where did you hear about this course?`)%>% count()%>% arrange(desc(n))
perc(data_Platform)
```


### Get top 7 How and where did you hear about this course?


```{r}
Platform_Name  <- data_Platform %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(Platform_Name)
```




```{r}
ggplot(data = Platform_Name, aes(x= n, y= `How and where did you hear about this course?` ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of How and where did you hear about this course?")
 
```


## Table of Which City are you currently residing in?

```{r}
data_City <- df_Course %>% group_by(`Which City are you currently residing in?`)%>% count()%>% arrange(desc(n))
perc(data_City)
```


## Creating new variable name City.

```{r}
df_Course <- df_Course %>% mutate(City = case_when(`Which City are you currently residing in?` == 'Karachi' ~'Karachi',
                                                   `Which City are you currently residing in?` == 'karachi' ~'Karachi',
                                                   `Which City are you currently residing in?` == 'Peshawar' ~'Peshawar',
                                                    `Which City are you currently residing in?` == 'KARACHI' ~'Karachi',
                                                    `Which City are you currently residing in?` == 'Islamabad' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'ISLAMABAD' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'islamabad' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'LAHORE' ~'Lahore',
                                                    `Which City are you currently residing in?` == 'Lahore' ~'Lahore',
                                                    `Which City are you currently residing in?` == 'Nowshera' ~'Nowshera',
                                                    `Which City are you currently residing in?` == 'Rawalpindi' ~'Rawalpindi',
                                                    `Which City are you currently residing in?` == 'Abbottabad' ~'Abbottabad',
                                                    `Which City are you currently residing in?` == 'Abbottabad Pakistan' ~'Abbottabad',
                                                    `Which City are you currently residing in?` == 'Ariana' ~'Ariana',
                                                    `Which City are you currently residing in?` == 'Batkhela, Malakand' ~'Batkhela',
                                                    `Which City are you currently residing in?` == 'Calgary' ~'Calgary',
                                                    `Which City are you currently residing in?` == 'Chakwal' ~'Chakwal',
                                                    `Which City are you currently residing in?` == 'D.I.Khan' ~'D.I.Khan',
                                                    `Which City are you currently residing in?` == 'Denver' ~'Denver',
                                                    `Which City are you currently residing in?` == 'Faisalabad' ~'Faisalabad',
                                                    `Which City are you currently residing in?` == 'Gilgit' ~'Gilgit',
                                                    `Which City are you currently residing in?` == 'Gohenberg' ~'Gohenberg',
                                                    `Which City are you currently residing in?` == 'Guelph' ~'Guelph',
                                                    `Which City are you currently residing in?` == 'Gujrat' ~'Gujrat',
                                                    `Which City are you currently residing in?` == 'Hail' ~'Hail',
                                                    `Which City are you currently residing in?` == 'Hyderabad' ~'Hyderabad',
                                                    `Which City are you currently residing in?` == 'Jamshoro' ~'Jamshoro',
                                                    `Which City are you currently residing in?` == 'Jaranwala' ~'Jaranwala',
                                                    `Which City are you currently residing in?` == 'Jeddah' ~'Jeddah',
                                                    `Which City are you currently residing in?` == 'Koln' ~'Koln',
                                                    `Which City are you currently residing in?` == 'Kushtia' ~'Kushtia',
                                                    `Which City are you currently residing in?` == 'Layyah' ~'Layyah',
                                                    `Which City are you currently residing in?` == 'Multan' ~'Multan',
                                                    `Which City are you currently residing in?` == 'Oakville' ~'Oakville',
                                                    `Which City are you currently residing in?` == 'Sheikhupura' ~'Sheikhupura',
                                                    `Which City are you currently residing in?` == 'Sialkot' ~'Sialkot',
                                                    `Which City are you currently residing in?` == 'Toronto' ~'Toronto',
                                                    `Which City are you currently residing in?` == 'NA' ~'na',
                                                    `Which City are you currently residing in?` == 'Pakistan' ~'na'))

```



## Table of Which City are you currently residing in?

```{r}
data_city <- df_Course %>% group_by(City)%>% count()%>% arrange(desc(n))
perc(data_city)
```


### Get top 7 Cities


```{r}
city_Name  <- data_city %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(city_Name)
```


### Bar chart of City

```{r}
ggplot(data = city_Name, aes(x= n, y= City ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of City")
 
```

## Table of Are you currently attending University / College?

```{r}
data_cStudy <- df_Course %>% group_by(`Are you currently attending University / College?`)%>% count()%>% arrange(desc(n))
perc(data_cStudy)
```


### Bar chart of Are you currently attending University / College?

```{r}
ggplot(data = data_cStudy, aes(x= n, y= `Are you currently attending University / College?` ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of Are you currently attending University / College?")
 
```

## Table of Latest Degree Completed or in Progress?

```{r}
data_lStudy <- df_Course %>% group_by(`Latest Degree Completed or in Progress?`)%>% count()%>% arrange(desc(n))
perc(data_lStudy)
```


### Bar chart of Latest Degree Completed or in Progress?

```{r}
ggplot(data = data_lStudy, aes(x= n, y= `Latest Degree Completed or in Progress?`))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of Latest Degree Completed or in Progress?")
 
```



## Table of Name of University or College currently or previously attended?

```{r}
data_Uni <- df_Course %>% group_by(`Name of University or College currently or previously attended?`)%>% count()%>% arrange(desc(n))
perc(data_Uni)
```

### Get top 7 Cities


```{r}
Uni_Name  <- data_Uni %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(Uni_Name)
```



### Bar chart of Latest Degree Completed or in Progress?

```{r}
ggplot(data = Uni_Name, aes(x= n, y= `Name of University or College currently or previously attended?`))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of Name of University or College")
 
```


## Table of 

```{r}
data_Degree <- df_Course %>% group_by(`Discipline of Degree?`)%>% count()%>% arrange(desc(n))
perc(data_Degree)
```


```{r}
df_Course <- df_Course %>% mutate(Paid_Course = case_when(df_Course$`Do you understand that this is a paid course ?...3` == 'Yes' ~'1',
                                                          df_Course$`Do you understand that this is a paid course ?...3` == 'yes' ~'1',
                                                          df_Course$`Do you understand that this is a paid course ?...3` == 'No' ~'0',
                                                          df_Course$`Do you understand that this is a paid course ?...3` == 'no' ~'0'))
```

### Table of Paid Course Understanding

```{r}
data_Paid <- df_Course %>% group_by(Paid_Course)%>% count()%>% arrange(desc(n))
perc(data_Paid)
```

### Bar chart of Paid Course Understanding.

```{r}
ggplot(data = data_Paid, aes(x= n, y= Paid_Course))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count ofPaid Course Understanding")
 
```

### Save Cleaned data

```{r}
library(rio)
export(df_Course, "Cleaned_CData.csv")
```

## ML Model.


## Rename Columns

```{r}
df_Course <- df_Course %>% 
           rename("hear_Course" = "How and where did you hear about this course?",
                  "Degree" = "Latest Degree Completed or in Progress?",
                  "Certificate"    = "Have you taken any foundational course in data science / econometrics / statistics / computer science?",
                  "Lang_of_Interest" = 'What programming language(s) are you most comfortable in (R, Python, Java, JS, etc.)? If none please type "None".',
                  #"Uni_Name" = 'Name of University or College currently or previously attended?',
                  #"Experience" ='Prior Work Experience in Data Science or Machine Learning'
                  
              )

colnames(df_Course)
```




```{r}
set.seed(1000)
fractionTraining   <- 0.50
fractionValidation <- 0.25
fractionTest       <- 0.25

# Compute sample sizes.
sampleSizeTraining   <- floor(fractionTraining   * nrow(df_Course))
sampleSizeValidation <- floor(fractionValidation * nrow(df_Course))
sampleSizeTest       <- floor(fractionTest       * nrow(df_Course))
```


Create the randomly-sampled indices for the dataframe. Use setdiff() to
 avoid overlapping subsets of indices.

```{r}

indicesTraining    <- sort(sample(seq_len(nrow(df_Course)), size=sampleSizeTraining))
indicesNotTraining <- setdiff(seq_len(nrow(df_Course)), indicesTraining)
indicesValidation  <- sort(sample(indicesNotTraining, size=sampleSizeValidation))
indicesTest        <- setdiff(indicesNotTraining, indicesValidation)
```

Finally, output the three dataframes for training, validation and test.

Training Set

```{r}

dfTraining   <- df_Course[indicesTraining, ]
nrow(dfTraining)


```

Validation Set


```{r}

dfValidation <- df_Course[indicesValidation, ]

nrow(dfValidation)
```

Test Set

```{r}

dfTest<- df_Course[indicesTest, ]

nrow(dfTest)

```



```{r}


```


```{r}
Train <- lapply(dfTraining, as.factor)

lm_model = lm(Age ~ Degree,Uni_Name, data = Train) 

```

```{r}
p1 <- predict(lm_model, Train, type = 'response')
head(p1)
```

```{r}
pred1 <- ifelse(p1>0.5, 1, 0)
tab1 <- table(Predicted = pred1, Actual = Train$Age)
tab1
```


```{r}
p1 <- predict(lm_model, dfTest, type = 'response')
head(p1)
```

