---
title: "Exploraotry Data Analysis"
author: "javaria"
date: '2022-09-30'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Describe Functions.

```{r}
perc <- function(data) {
  percent <- data %>% ungroup() %>% mutate(Percentage = (n/sum(n))*100)
  return(percent)
}

```


```{r}
library(tidyverse)
library(formattable)
library(leaflet)
```


# Read Dataset

```{r}
df_Course <- read_csv("Data/Data - DS C1 Course.csv")
```

# Univariate Analysis


## Table of Age

```{r}
data_Age <- df_Course %>% group_by(Age)%>% count()%>% arrange(desc(n))
perc(data_Age)
```


### Get top 7 Age Numbers


```{r}
Age_Name  <- data_Age %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(Age_Name)
```


### Bar chart of Age

```{r}
ggplot(data = Age_Name, aes(x= n, y= Age ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of Age")
 
```


## Table of How and where did you hear about this course?

```{r}
data_Platform <- df_Course %>% group_by(`How and where did you hear about this course?`)%>% count()%>% arrange(desc(n))
perc(data_Platform)
```


### Get top 7 How and where did you hear about this course?


```{r}
Platform_Name  <- data_Platform %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(Platform_Name)
```




```{r}
ggplot(data = Platform_Name, aes(x= n, y= `How and where did you hear about this course?` ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of How and where did you hear about this course?")
 
```


## Table of Which City are you currently residing in?

```{r}
data_City <- df_Course %>% group_by(`Which City are you currently residing in?`)%>% count()%>% arrange(desc(n))
perc(data_City)
```


## Creating new variable name City.

```{r}
df_Course <- df_Course %>% mutate(City = case_when(`Which City are you currently residing in?` == 'Karachi' ~'Karachi',
                                                   `Which City are you currently residing in?` == 'karachi' ~'Karachi',
                                                   `Which City are you currently residing in?` == 'Peshawar' ~'Peshawar',
                                                    `Which City are you currently residing in?` == 'KARACHI' ~'Karachi',
                                                    `Which City are you currently residing in?` == 'Islamabad' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'ISLAMABAD' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'islamabad' ~'Islamabad',
                                                    `Which City are you currently residing in?` == 'LAHORE' ~'Lahore',
                                                    `Which City are you currently residing in?` == 'Lahore' ~'Lahore',
                                                    `Which City are you currently residing in?` == 'Nowshera' ~'Nowshera',
                                                    `Which City are you currently residing in?` == 'Rawalpindi' ~'Rawalpindi',
                                                    `Which City are you currently residing in?` == 'Abbottabad' ~'Abbottabad',
                                                    `Which City are you currently residing in?` == 'Abbottabad Pakistan' ~'Abbottabad',
                                                    `Which City are you currently residing in?` == 'Ariana' ~'Ariana',
                                                    `Which City are you currently residing in?` == 'Batkhela, Malakand' ~'Batkhela',
                                                    `Which City are you currently residing in?` == 'Calgary' ~'Calgary',
                                                    `Which City are you currently residing in?` == 'Chakwal' ~'Chakwal',
                                                    `Which City are you currently residing in?` == 'D.I.Khan' ~'D.I.Khan',
                                                    `Which City are you currently residing in?` == 'Denver' ~'Denver',
                                                    `Which City are you currently residing in?` == 'Faisalabad' ~'Faisalabad',
                                                    `Which City are you currently residing in?` == 'Gilgit' ~'Gilgit',
                                                    `Which City are you currently residing in?` == 'Gohenberg' ~'Gohenberg',
                                                    `Which City are you currently residing in?` == 'Guelph' ~'Guelph',
                                                    `Which City are you currently residing in?` == 'Gujrat' ~'Gujrat',
                                                    `Which City are you currently residing in?` == 'Hail' ~'Hail',
                                                    `Which City are you currently residing in?` == 'Hyderabad' ~'Hyderabad',
                                                    `Which City are you currently residing in?` == 'Jamshoro' ~'Jamshoro',
                                                    `Which City are you currently residing in?` == 'Jaranwala' ~'Jaranwala',
                                                    `Which City are you currently residing in?` == 'Jeddah' ~'Jeddah',
                                                    `Which City are you currently residing in?` == 'Koln' ~'Koln',
                                                    `Which City are you currently residing in?` == 'Kushtia' ~'Kushtia',
                                                    `Which City are you currently residing in?` == 'Layyah' ~'Layyah',
                                                    `Which City are you currently residing in?` == 'Multan' ~'Multan',
                                                    `Which City are you currently residing in?` == 'Oakville' ~'Oakville',
                                                    `Which City are you currently residing in?` == 'Sheikhupura' ~'Sheikhupura',
                                                    `Which City are you currently residing in?` == 'Sialkot' ~'Sialkot',
                                                    `Which City are you currently residing in?` == 'Toronto' ~'Toronto',
                                                    `Which City are you currently residing in?` == 'NA' ~'na',
                                                    `Which City are you currently residing in?` == 'Pakistan' ~'na'))

```



## Table of Which City are you currently residing in?

```{r}
data_city <- df_Course %>% group_by(City)%>% count()%>% arrange(desc(n))
perc(data_city)
```


### Get top 7 Cities


```{r}
city_Name  <- data_city %>% ungroup() %>% top_n(7, n) %>% arrange(desc(n))
perc(city_Name)
```


### Bar chart of City

```{r}
ggplot(data = city_Name, aes(x= n, y= City ))+
  geom_bar(stat= "identity",  fill = "#21B6A8")+
  geom_text(aes(label = n), vjust = -0.2)+
  ggtitle("Count of City")
 
```